"""
(C) 2025 Airbus copyright all rights reserved
16/01/2025
"""
import torch

x = torch.tensor([[[[1.0, 2.0, 3.0, 4.0, 5.0],
                   [1.0, 2.0, 3.0, 4.0, 5.0],
                   [1.0, 2.0, 3.0, 4.0, 5.0],
                   [1.0, 2.0, 3.0, 4.0, 5.0],
                   [1.0, 2.0, 3.0, 4.0, 5.0]],

                   [[2.0, 3.0, 4.0, 5.0, 6.0],
                    [2.0, 3.0, 4.0, 5.0, 6.0],
                   [2.0, 3.0, 4.0, 5.0, 6.0],
                   [2.0, 3.0, 4.0, 5.0, 6.0],
                   [2.0, 3.0, 4.0, 5.0, 6.0]]]])

ker = torch.tensor([[[[1.0, 0.0, 1.0],
                     [2.0, 0.0, 2.0],
                     [1.0, 0.0, 1.0]],
                    [[1.0, 1.0, 1.0],
                     [2.0, 2.0, 2.0],
                     [1.0, 1.0, 1.0]]],
                   [[[1.0, 0.0, 1.0],
                     [1.0, 0.0, 1.0],
                     [1.0, 0.0, 1.0]],
                    [[1.0, 1.0, 1.0],
                     [0.0, 0.0, 0.0],
                     [1.0, 1.0, 1.0]]]])

bias = torch.tensor([1.0, 2.0])

res = torch.nn.functional.conv2d(x, weight=ker, bias=bias, padding='same')

print(res)

print(ker.shape)
